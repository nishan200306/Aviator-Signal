<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Aviator Signal</title>

  <link rel="preconnect" href="https://cdn.simpleicons.org" crossorigin>
  <link rel="dns-prefetch" href="//cdn.simpleicons.org">
  <link rel="preload" as="image" href="https://cdn.simpleicons.org/facebook/FFFFFF" crossorigin>
  <link rel="preload" as="image" href="https://cdn.simpleicons.org/whatsapp/FFFFFF" crossorigin>
  <link rel="preload" as="image" href="https://cdn.simpleicons.org/youtube/FFFFFF" crossorigin>
  <link rel="preload" as="image" href="https://cdn.simpleicons.org/telegram/FFFFFF" crossorigin>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&family=Poppins:wght@600;700&display=swap" rel="stylesheet" />

  <style>
    :root{
      /* Deep red theme */
      --bg-deep: #120207;       /* world base */
      --bg-red-1: #2b0a12;      /* top red */
      --bg-red-2: #0b0306;      /* bottom red */

      --red-1: #FF3B4E;         /* neon red */
      --red-2: #FF1744;
      --text: #FCEFF2;
      --card-border: #FF3B4E66;
      --btn-bg: #2B0A12;

      --ok: #28e77a;
      --ok-bg: rgba(40,231,122,0.14);
      --ok-border: rgba(40,231,122,0.6);

      --bad: #ff5a5a;

      --fb:#1877F2; --yt:#FF0000; --wa:#25D366; --tg:#229ED9;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body {
      font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      /* Body background also tinted red */
      background: radial-gradient(circle at 50% -10%, var(--bg-red-1) 0%, var(--bg-red-2) 70%);
      overflow: hidden;
    }

    /* Brand header */
    .topbar {
      position: fixed; top: 0; left: 0; right: 0; z-index: 5;
      display: grid; place-items: center;
      padding: 12px 16px 6px 16px;
      background: linear-gradient(180deg, rgba(255,59,78,0.18), rgba(0,0,0,0));
      pointer-events: none;
    }
    .brand {
      pointer-events: auto; margin: 0;
      font-weight: 900; letter-spacing: 1px;
      font-size: clamp(22px, 5vw, 34px);
      color: var(--red-1);
      text-shadow: 0 0 16px rgba(255,59,78,0.6), 0 0 32px rgba(255,23,68,0.45);
      font-family: 'Orbitron', system-ui, sans-serif;
    }
    .subtag {
      pointer-events: auto;
      margin-top: 4px;
      font-size: 12px; font-weight: 800; letter-spacing: .3px;
      color: #ffb3bd;
      text-shadow: 0 0 10px rgba(255,59,78,0.35);
      white-space: nowrap;
    }
    .promoCode{
      display: inline-flex; align-items: center; gap: 6px;
      padding: 2px 8px; border-radius: 999px;
      border: 1px solid var(--ok-border);
      background: var(--ok-bg);
      color: var(--ok); font-weight: 900;
      white-space: nowrap;
      box-shadow: inset 0 0 10px rgba(40,231,122,.25), 0 0 10px rgba(40,231,122,.18);
    }

    /* World (UI + bg) ‚Äî now deep red */
    #world {
      position: relative; width: 100%; height: 100%;
      opacity: 0;
      clip-path: circle(0% at 50% 50%);
      transition: opacity .45s ease, clip-path .9s cubic-bezier(0.22,1,0.36,1);
    }
    #world.reveal {
      opacity: 1;
      clip-path: circle(150% at 50% 50%);
      background: radial-gradient(circle at 50% -10%, var(--bg-red-1) 0%, var(--bg-deep) 70%) fixed;
    }

    /* Starfield (kept) + extra red glow overlay */
    #starfield { position: fixed; inset: 0; z-index: 0; }
    .overlay {
      position: fixed; inset: 0; z-index: 1; pointer-events: none;
      background:
        radial-gradient(80% 60% at 50% 12%, rgba(255,59,78,0.25), rgba(0,0,0,0)),
        radial-gradient(60% 40% at 80% 80%, rgba(255,23,68,0.15), rgba(0,0,0,0));
      mix-blend-mode: screen;
    }

    /* Screens */
    .app { position: relative; z-index: 2; height: 100%; padding-top: 92px; }
    .screen {
      position: absolute; inset: 92px 16px 16px 16px;
      display: grid; place-items: center;
      transition: opacity .25s ease, transform .25s ease, visibility .25s ease;
    }
    .screen.hidden { opacity: 0; transform: translateX(24px); visibility: hidden; pointer-events: none; }
    .screen.show   { opacity: 1; transform: translateX(0); visibility: visible; }

    .container {
      width: min(520px, 92vw);
      display: flex; flex-direction: column; gap: 18px; align-items: center;
      background: linear-gradient(180deg, rgba(43,10,18,0.55), rgba(43,10,18,0.28));
      border: 2px solid var(--card-border); border-radius: 16px;
      padding: 22px 18px 24px;
      box-shadow: 0 0 28px 2px rgba(255,59,78,0.22), 0 0 60px 12px rgba(255,59,78,0.14);
      backdrop-filter: blur(4px);
    }

    .display { width: 100%; padding: 24px 18px; border-radius: 16px; background: rgba(255,59,78,0.06); border: 2px solid var(--card-border); box-shadow: 0 0 24px rgba(255,59,78,0.22), inset 0 0 24px rgba(255,59,78,0.08); text-align: center; user-select: none; }
    .odd { font-family: 'Orbitron', monospace; font-weight: 800; font-size: clamp(42px, 10vw, 64px); color: var(--red-1); letter-spacing: 1.5px; text-shadow: 0 0 22px rgba(255,82,82,0.6), 0 0 48px rgba(255,82,82,0.4); transition: transform .18s ease; }
    .odd.pop { transform: scale(1.06); }

    .btn { width: 100%; padding: 16px 18px; border-radius: 14px; border: none; color: #fff; background: var(--btn-bg); font-family: 'Orbitron', sans-serif; font-weight: 800; font-size: clamp(18px, 3.8vw, 24px); letter-spacing: 1.2px; cursor: pointer; box-shadow: 0 8px 24px rgba(255,59,78,0.35), 0 0 24px rgba(255,59,78,0.25); transition: transform .06s ease, filter .2s ease, background .2s ease; }
    .btn:hover { filter: brightness(1.06); }
    .btn:active { transform: translateY(1px) scale(0.995); }

    .tools { width: 100%; display: flex; gap: 10px; flex-wrap: wrap; }
    .small-btn { flex: 1; min-width: 120px; padding: 10px 12px; border-radius: 10px; border: 1px solid var(--card-border); background: rgba(255,59,78,0.08); color: #FFECEF; font-size: 13px; cursor: pointer; font-weight: 700; }

    .socials { display: flex; gap: 14px; margin-top: 6px; }
    .socials a { width: 46px; height: 46px; display: grid; place-items: center; border-radius: 50%; color: #fff; text-decoration: none; box-shadow: 0 0 14px rgba(255,59,78,0.2), 0 4px 12px rgba(0,0,0,0.35); }
    .socials img { width: 22px; height: 22px; display: block; }
    .socials a[data-brand="facebook"] { background: var(--fb); }
    .socials a[data-brand="youtube"]  { background: var(--yt); }
    .socials a[data-brand="whatsapp"] { background: var(--wa); }
    .socials a[data-brand="telegram"] { background: var(--tg); }

    .history { width: 100%; display: grid; gap: 8px; }
    .history-row { display: flex; justify-content: space-between; font-family: 'Orbitron', monospace; font-size: 14px; opacity: 0.9; }
    .history-row .tag { padding: 4px 8px; background: rgba(255,59,78,0.08); border: 1px solid var(--card-border); border-radius: 8px; }

    /* Connect */
    .backRow { width: 100%; display: flex; justify-content: space-between; align-items: center; }
    .linkBtn { background: transparent; border: 1px solid var(--card-border); color: var(--text); padding: 8px 12px; border-radius: 10px; cursor: pointer; font-weight: 700; }

    .connect-panel { width: 100%; display: grid; gap: 12px; }
    .field { display: grid; grid-template-columns: 130px 1fr; gap: 10px; align-items: center; }
    .field label { font-weight: 700; font-size: 13px; color: #ffd2d8; }
    .field input { background: rgba(255,255,255,0.05); border: 1.5px solid var(--card-border); color: var(--text); padding: 10px 12px; border-radius: 10px; outline: none; }
    .sysBtn { justify-self: start; padding: 10px 14px; border-radius: 10px; border: 1.5px solid var(--card-border); background: rgba(255,59,78,0.1); color: #ffeef1; font-weight: 800; cursor: pointer; letter-spacing: .6px; }
    .status { justify-self: start; padding: 8px 12px; border-radius: 10px; font-weight: 800; letter-spacing: .6px; display: none; }
    .status.ok  { display:inline-block; color: var(--ok);  background: rgba(40,231,122,0.12); border: 1.5px solid rgba(40,231,122,0.45); text-shadow: 0 0 8px rgba(40,231,122,0.25); }
    .status.bad { display:inline-block; color: var(--bad); background: rgba(255,90,90,0.12); border: 1.5px solid rgba(255,90,90,0.45); text-shadow: 0 0 8px rgba(255,90,90,0.25); }

    /* Feedback */
    .feedWrap { width: 100%; display: grid; gap: 14px; }
    .feedList { list-style: none; margin: 0; padding: 0; display: grid; gap: 12px; }
    .feedItem { display: grid; gap: 6px; padding: 10px 12px; border-radius: 12px; background: rgba(255,59,78,0.06); border: 1.5px solid var(--card-border); }
    .feedHead { display: flex; align-items: center; gap: 10px; }
    .avatar{ width: 40px; height: 40px; border-radius: 50%; display: grid; place-items: center; background: var(--avbg, #7b2230); color: #ffffff; box-shadow: 0 0 12px rgba(255,59,78,0.25); }
    .avatar svg{ width: 22px; height: 22px; opacity: .95; filter: drop-shadow(0 0 6px rgba(0,0,0,0.15)); }
    .name { font-weight: 800; letter-spacing: .3px; }
    .msg { opacity: .95; line-height: 1.45; white-space: pre-line; }

    .sendBox { display: grid; gap: 10px; padding: 12px; border-radius: 12px; background: rgba(255,59,78,0.06); border: 1.5px solid var(--card-border); }
    .sendBox .row2 { display: grid; gap: 10px; }
    .sendBox input, .sendBox textarea { background: rgba(255,255,255,0.05); border: 1.5px solid var(--card-border); color: var(--text); padding: 10px 12px; border-radius: 10px; outline: none; font-family: 'Poppins', system-ui, sans-serif; }
    .sendBox textarea { min-height: 80px; resize: vertical; }
    .sendBox .actions { display: flex; gap: 10px; align-items: center; }
    .note { font-size: 12px; opacity: .8; }

    .hidden { display: none !important; }

    /* Intro overlay + deep red bg + odds rain (now red) */
    #intro {
      position: fixed; inset: 0; z-index: 10; display: grid; place-items: center;
      background:
        radial-gradient(70% 60% at 50% 40%, rgba(120,10,24,0.88), rgba(20,0,6,0.96));
      opacity: 0; visibility: hidden; transition: opacity .4s ease, visibility .4s ease;
    }
    #intro.show { opacity: 1; visibility: visible; }
    #introOdd { position: absolute; inset: 0; z-index: 0; }

    .skipIntro { position: absolute; top: 14px; right: 14px; z-index: 3; padding: 6px 10px; border-radius: 10px; border: 1px solid var(--card-border); background: rgba(255,255,255,0.06); color: var(--text); font-weight: 800; cursor: pointer; }
    .badge { position: relative; z-index: 2; width: 180px; height: 180px; border-radius: 50%; display: grid; place-items: center; background: radial-gradient(circle at 50% 50%, rgba(255,23,68,0.24), rgba(255,59,78,0.08)); border: 2px solid rgba(255,59,78,0.35); box-shadow: 0 0 32px rgba(255,59,78,0.35), inset 0 0 36px rgba(255,59,78,0.22); animation: popIn .45s ease both; overflow: visible; }
    .ring { position: absolute; inset: -16px; border-radius: 50%; border: 2px solid transparent; }
    .ring.r1 { border-top-color: var(--red-1); border-left-color: var(--red-1); animation: spin 2.6s linear infinite; }
    .ring.r2 { inset: -32px; border-bottom-color: var(--red-2); border-right-color: var(--red-2); animation: spin 3.6s linear infinite reverse; opacity: .75; }
    .ring.r3 { inset: -52px; border-top-color: rgba(255,59,78,.55); animation: spin 5.2s linear infinite; opacity: .55; }

    /* Center icon: paper-plane SVG in solid red (no white) */
    .aviator { width: 90px; height: 90px; color: var(--red-1); filter: drop-shadow(0 0 12px rgba(255,59,78,0.6)); }

    /* Bottom loader */
    .bottomLoad { position: absolute; left: 24px; right: 24px; bottom: 26px; display: grid; gap: 8px; z-index: 2; }
    .loadBar { width: 100%; height: 10px; border-radius: 999px; overflow: hidden; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.16); box-shadow: inset 0 0 8px rgba(0,0,0,0.45), 0 0 16px rgba(255,59,78,0.25); }
    .loadFill { height: 100%; width: 1%; background: linear-gradient(90deg, #ff1744, #ff6a6a); box-shadow: 0 0 18px rgba(255,59,78,0.55); border-right: 2px solid rgba(255,255,255,0.45); transition: width .06s linear; }
    .loadLabel { justify-self: end; font-family: 'Orbitron', monospace; font-weight: 900; font-size: 12px; color: #ffdbe0; text-shadow: 0 0 10px rgba(255,59,78,0.45); letter-spacing: 1px; }

    @keyframes spin { to { transform: rotate(360deg); } }
    @keyframes popIn { from { transform: scale(.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  </style>
</head>
<body>

  <!-- Intro overlay with red background + odds rain -->
  <div id="intro" aria-modal="true" role="dialog">
    <canvas id="introOdd"></canvas>
    <button class="skipIntro" id="skipIntro">Skip ‚úï</button>

    <div class="badge">
      <div class="ring r1"></div>
      <div class="ring r2"></div>
      <div class="ring r3"></div>

      <!-- Solid red aviator icon -->
      <svg class="aviator" viewBox="0 0 64 64" fill="currentColor" aria-hidden="true">
        <path d="M58 6 6 28l16 6 4 18 8-13 18 12 6-45z"></path>
      </svg>
    </div>

    <!-- Bottom loader -->
    <div class="bottomLoad">
      <div class="loadBar"><div class="loadFill" id="barFill"></div></div>
      <div class="loadLabel"><span id="barPct">1%</span></div>
    </div>
  </div>

  <!-- World (revealed after intro) -->
  <div id="world">
    <canvas id="starfield" aria-hidden="true"></canvas>
    <div class="overlay" aria-hidden="true"></div>

    <header class="topbar">
      <h1 class="brand">Aviator Signal</h1>
      <div class="subtag">
        this hack works only with this promo code
        <span class="promoCode">VIPCNA</span>
      </div>
    </header>

    <main class="app" role="main">
      <!-- Home -->
      <section id="home" class="screen show">
        <div class="container">
          <div class="display" aria-live="polite">
            <div id="odd" class="odd">x0.00</div>
          </div>
          <button id="generate" class="btn">GENERATE</button>

          <div class="tools">
            <button id="connectBtn" class="small-btn">Connect</button>
            <button id="feedbackBtn" class="small-btn">Customer Feedback</button>
            <button id="clearBtn" class="small-btn">Clear History</button>
          </div>

          <div id="history" class="history" aria-label="Recent values"></div>

          <div class="socials" aria-label="Social links">
            <a class="open-tg" data-brand="facebook" href="#" aria-label="Facebook">
              <img alt="Facebook" src="https://cdn.simpleicons.org/facebook/FFFFFF" width="22" height="22">
            </a>
            <a class="open-tg" data-brand="whatsapp" href="#" aria-label="WhatsApp">
              <img alt="WhatsApp" src="https://cdn.simpleicons.org/whatsapp/FFFFFF" width="22" height="22">
            </a>
            <a class="open-tg" data-brand="youtube" href="#" aria-label="YouTube">
              <img alt="YouTube" src="https://cdn.simpleicons.org/youtube/FFFFFF" width="22" height="22">
            </a>
            <a class="open-tg" data-brand="telegram" href="#" aria-label="Telegram">
              <img alt="Telegram" src="https://cdn.simpleicons.org/telegram/FFFFFF" width="22" height="22">
            </a>
          </div>
        </div>
      </section>

      <!-- Connect -->
      <section id="connect" class="screen hidden" aria-label="Connect to system">
        <div class="container">
          <div class="backRow" style="width:100%">
            <button id="backHome" class="linkBtn">‚Üê Back</button>
            <div style="opacity:.8;font-size:13px">Secure connect</div>
          </div>

          <div class="connect-panel">
            <div class="field">
              <label for="gameId">Your Game ID</label>
              <input id="gameId" type="text" placeholder="Enter your game id" autocomplete="username">
            </div>
            <div class="field">
              <label for="pwd">Password</label>
              <input id="pwd" type="password" placeholder="password" value="" autocomplete="current-password">
            </div>

            <button id="sysConnect" class="sysBtn">System Connect</button>
            <div id="connStatus" class="status" aria-live="polite"></div>
          </div>
        </div>
      </section>

      <!-- Feedback -->
      <section id="feedback" class="screen hidden" aria-label="Customer feedback">
        <div class="container">
          <div class="backRow" style="width:100%">
            <button id="backFromFeedback" class="linkBtn">‚Üê Back</button>
            <div style="opacity:.8;font-size:13px">Customer feedback</div>
          </div>

          <div class="feedWrap">
            <ul id="feedList" class="feedList"></ul>

            <div class="sendBox">
              <div class="row2">
                <input id="fbName" placeholder="Your name (optional)">
                <textarea id="fbText" placeholder="Type your feedback..."></textarea>
              </div>
              <div class="actions">
                <button id="fbSend" class="sysBtn">Send</button>
                <div id="fbNote" class="note"></div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    (function() {
      'use strict';

      // --- DOM Element Selectors ---
      const intro = document.getElementById('intro');
      const skipIntro = document.getElementById('skipIntro');
      const world = document.getElementById('world');
      const barFill = document.getElementById('barFill');
      const barPct = document.getElementById('barPct');
      const oddCanvas = document.getElementById('introOdd');
      const starfieldCanvas = document.getElementById('starfield');
      const oddEl = document.getElementById('odd');
      const genBtn = document.getElementById('generate');
      const clearBtn = document.getElementById('clearBtn');
      const historyEl = document.getElementById('history');
      const homeScr = document.getElementById('home');
      const connectScr = document.getElementById('connect');
      const feedbackScr = document.getElementById('feedback');
      const connectBtn = document.getElementById('connectBtn');
      const feedbackBtn = document.getElementById('feedbackBtn');
      const backHome = document.getElementById('backHome');
      const backFromFeedback = document.getElementById('backFromFeedback');
      const sysConnect = document.getElementById('sysConnect');
      const gameIdInput = document.getElementById('gameId');
      const pwdInput = document.getElementById('pwd');
      const connStatus = document.getElementById('connStatus');
      const feedList = document.getElementById('feedList');
      const fbNameInput = document.getElementById('fbName');
      const fbTextInput = document.getElementById('fbText');
      const fbSendBtn = document.getElementById('fbSend');
      const fbNote = document.getElementById('fbNote');

      // --- Intro & Loading Screen ---
      const INTRO_TIME = 2200; // ms
      let introDone = false;

      function openIntro() {
        intro.classList.add('show');
        startOddsRain();
        startBottomLoader();
      }

      function closeIntro() {
        if (introDone) return;
        introDone = true;
        intro.classList.remove('show');
        stopOddsRain();
        world.classList.add('reveal');
        setTimeout(() => resizeStarfield(), 50);
      }

      function startBottomLoader() {
        const start = performance.now();
        function step(now) {
          if (introDone) return;
          const t = Math.min((now - start) / INTRO_TIME, 1);
          const pct = Math.max(1, Math.round(t * 100));
          barFill.style.width = pct + '%';
          barPct.textContent = pct + '%';
          if (t < 1) requestAnimationFrame(step);
          else closeIntro();
        }
        requestAnimationFrame(step);
      }
      
      // --- Odds Rain Animation (Intro) ---
      const octx = oddCanvas.getContext('2d', { alpha: true });
      let oWidth = 0, oHeight = 0, oDpr = 1, rainCols = [], rainRAF = 0;
      const ROW_H = 24, COL_W = 110, FADE_ALPHA = 0.16;

      function resizeOddsRain() {
        oDpr = Math.min(window.devicePixelRatio || 1, 2);
        oWidth = innerWidth; oHeight = innerHeight;
        oddCanvas.width = Math.floor(oWidth * oDpr);
        oddCanvas.height = Math.floor(oHeight * oDpr);
        oddCanvas.style.width = oWidth + 'px';
        oddCanvas.style.height = oHeight + 'px';
        octx.setTransform(oDpr, 0, 0, oDpr, 0, 0);

        const cols = Math.max(1, Math.floor(oWidth / COL_W));
        rainCols = [];
        for (let i = 0; i < cols; i++) {
          rainCols.push({
            x: Math.floor((i + 0.1 + Math.random() * 0.8) * COL_W),
            y: -Math.random() * 200, vy: 120 + Math.random() * 180,
            nextY: 0, text: generateRandomOddString()
          });
        }
        octx.font = "bold 18px 'Orbitron', monospace";
        octx.textBaseline = 'top';
        octx.shadowColor = 'rgba(255,59,78,0.55)';
      }
      
      function stepOddsRain(dt) {
        octx.fillStyle = `rgba(20,0,6,${FADE_ALPHA})`;
        octx.fillRect(0, 0, oWidth, oHeight);

        for (const col of rainCols) {
          col.y += col.vy * dt;
          if (col.y - col.nextY >= ROW_H) {
            col.text = generateRandomOddString();
            col.nextY = col.y;
          }
          octx.fillStyle = 'rgba(255,59,78,0.92)';
          octx.shadowBlur = 10;
          octx.fillText(col.text, col.x, col.y);

          if (col.y > oHeight + ROW_H) {
            col.y = -Math.random() * 200;
            col.nextY = col.y;
            col.vy = 120 + Math.random() * 180;
            col.text = generateRandomOddString();
          }
        }
      }

      function startOddsRain() {
        resizeOddsRain();
        let last = performance.now();
        function loop(now) {
          const dt = Math.min((now - last) / 1000, 0.05);
          last = now;
          stepOddsRain(dt);
          rainRAF = requestAnimationFrame(loop);
        }
        rainRAF = requestAnimationFrame(loop);
        window.addEventListener('resize', resizeOddsRain);
      }
      function stopOddsRain() {
        cancelAnimationFrame(rainRAF);
        window.removeEventListener('resize', resizeOddsRain);
        octx.clearRect(0, 0, oWidth, oHeight);
      }

      // --- Main App: Odds Generation & History ---
      const history = [];
      const scriptedOdds = [118.52, 1.00, 5.02, 1.57];
      let scriptIndex = 0;
      const formatOdd = (n) => 'x' + n.toFixed(2);
      
      function generateRandomOdd() {
        const r = Math.random();
        let v;
        if (r < 0.70) v = 1.00 + Math.random() * 1.00;
        else if (r < 0.90) v = 2.00 + Math.random() * 3.00;
        else v = 5.00 + Math.random() * 20.00;
        return Math.round(v * 100) / 100;
      }

      function generateRandomOddString() { return formatOdd(generateRandomOdd()); }

      function handleGenerateClick() {
        const v = (scriptIndex < scriptedOdds.length) ? scriptedOdds[scriptIndex++] : generateRandomOdd();
        oddEl.textContent = formatOdd(v);
        oddEl.classList.add('pop');
        setTimeout(() => oddEl.classList.remove('pop'), 160);
        pushHistory(v);
      }

      function pushHistory(val) {
        history.unshift({ val, at: new Date() });
        if (history.length > 3) history.pop();
        renderHistory();
      }

      function renderHistory() {
        historyEl.innerHTML = history.map(h => {
          const t = h.at.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', second: '2-digit' });
          return `<div class="history-row"><span>${t}</span><span class="tag">${formatOdd(h.val)}</span></div>`;
        }).join('');
      }

      // --- Main App: Screen Navigation ---
      function showScreen(name) {
        const screens = { home: homeScr, connect: connectScr, feedback: feedbackScr };
        Object.keys(screens).forEach(key => {
          screens[key].classList.toggle('show', key === name);
          screens[key].classList.toggle('hidden', key !== name);
        });
        if (name === 'connect') setTimeout(() => gameIdInput.focus(), 50);
        if (name === 'feedback') setTimeout(() => fbTextInput.focus(), 80);
      }

      // --- Connect Screen Logic (Fake) ---
      function handleSystemConnect() {
        const isOk = pwdInput.value.trim().toLowerCase() === 'vipcna';
        connStatus.textContent = isOk ? 'System Connected' : 'System Disconnected';
        connStatus.className = 'status ' + (isOk ? 'ok' : 'bad');
      }

      // --- Social Links ---
      function handleSocialLink(e) {
        e.preventDefault();
        // <<< ‡∂î‡∂∂ ‡∂â‡∂Ω‡∑ä‡∂Ω‡∑è ‡∑É‡∑í‡∂ß‡∑í Telegram username ‡∑Ä‡∑ô‡∂±‡∑É ‡∂∏‡∑ô‡∂≠‡∂± ‡∑É‡∑í‡∂Ø‡∑î‡∂ö‡∂ª ‡∂á‡∂≠ >>>
        const TG_USER = 'virat1xbet'; 
        const deepLink = `tg://resolve?domain=${TG_USER}`;
        const webLink = `https://t.me/${TG_USER}`;
        // Try opening the deep link first.
        // For security, some browsers block this. A timeout fallback to the web link is a common pattern.
        window.location.href = deepLink;
        setTimeout(() => {
            // If the user is still on the page after a short time, they likely don't have Telegram installed.
            // Open the web link in a new tab.
            window.open(webLink, '_blank', 'noopener,noreferrer');
        }, 500);
      }
      
      // --- Feedback Screen Logic (Fake) ---
      const INITIAL_FEEDS = [
        { name: 'Dulan Chamika', msg: `This is amazing, 100% sure signals! üî•\nAfter creating a new 1XBET account with the VIPCNA code,\nthe signals started working perfectly for me. üí∏ü§©‚ù§Ô∏è`, },
        { name: 'Dilshan Jayavardana', msg: 'The best signals, really amazing!' },
        { name: 'Jane Perera', msg: 'I was down by 800k, but I recovered my entire loss in just three days thanks to this app. Truly grateful!' },
        { name: 'Wasantha Jayathilake', msg: 'Thanks Brother, Aviator Signal is awesome! ‚ù§Ô∏è' },
      ];
      const AV_COLORS = ['#e53935','#d81b60','#8e24aa','#3949ab','#1e88e5','#00897b','#7cb342','#f9a825','#ef6c00'];
      const PERSON_SVG = `<svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10zm0 2c-4.4 0-8 2.2-8 5v1h16v-1c0-2.8-3.6-5-8-5z"/></svg>`;
      
      const escapeHtml = (t) => t.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
      const highlightPromo = (text) => escapeHtml(text).replace(/\bVIPCNA\b/gi, '<span class="promoCode">VIPCNA</span>');
      
      function createFeedItem(name, message) {
        let h=0; for (let i=0;i<name.length;i++){ h = (h*31 + name.charCodeAt(i))>>>0; }
        const color = AV_COLORS[h % AV_COLORS.length];
        
        const li = document.createElement('li');
        li.className = 'feedItem';
        li.innerHTML = `
          <div class="feedHead">
            <div class="avatar" style="--avbg: ${color}">${PERSON_SVG}</div>
            <div class="name">${escapeHtml(name)}</div>
          </div>
          <div class="msg">${highlightPromo(message)}</div>`;
        return li;
      }
      
      function renderInitialFeeds() {
        feedList.innerHTML = '';
        INITIAL_FEEDS.forEach(f => feedList.appendChild(createFeedItem(f.name, f.msg)));
      }
      
      function handleSendFeedback() {
        const name = (fbNameInput.value.trim() || 'Anonymous');
        const text = fbTextInput.value.trim();
        if (!text) {
          fbNote.textContent = 'Please type your feedback first.';
          return;
        }
        feedList.prepend(createFeedItem(name, text));
        fbTextInput.value = '';
        fbNameInput.value = '';
        fbNote.textContent = 'Sent ‚úì';
        setTimeout(() => fbNote.textContent = '', 1200);
      }

      // --- Background Starfield Animation ---
      const sctx = starfieldCanvas.getContext('2d', { alpha: true });
      let stars = [], sWidth = 0, sHeight = 0, sDpr = 1;

      function resizeStarfield() {
        sDpr = Math.min(window.devicePixelRatio || 1, 2);
        sWidth = innerWidth; sHeight = innerHeight;
        starfieldCanvas.width = Math.floor(sWidth * sDpr);
        starfieldCanvas.height = Math.floor(sHeight * sDpr);
        starfieldCanvas.style.width = sWidth + 'px';
        starfieldCanvas.style.height = sHeight + 'px';
        sctx.setTransform(sDpr, 0, 0, sDpr, 0, 0);
        
        const count = Math.min(220, Math.floor((sWidth * sHeight) / 9000));
        stars = [];
        for (let i = 0; i < count; i++) {
          const r = 0.4 + Math.random() * 1.6;
          const speed = 10 + r * 35;
          const angle = (-90 + (Math.random() * 20 - 10)) * Math.PI / 180;
          stars.push({
            x: Math.random() * sWidth, y: Math.random() * sHeight, r,
            vx: Math.cos(angle) * speed, vy: Math.sin(angle) * speed,
            twPhase: Math.random() * Math.PI * 2, twSpeed: 0.6 + Math.random() * 1.4,
          });
        }
      }

      let lastT = performance.now();
      function animateStarfield(now) {
        const dt = Math.min((now - lastT) / 1000, 0.05); lastT = now;
        sctx.clearRect(0, 0, sWidth, sHeight);
        for (const s of stars) {
          s.x += s.vx * dt; s.y += s.vy * dt;
          if (s.x < -8) s.x = sWidth + 8; if (s.x > sWidth + 8) s.x = -8;
          if (s.y < -8) s.y = sHeight + 8; if (s.y > sHeight + 8) s.y = -8;
          const tw = (Math.sin(now / 1000 * (1.2 * s.twSpeed) + s.twPhase) + 1) / 2;
          const alpha = 0.25 + tw * 0.65;
          const rad = s.r * (0.9 + tw * 0.35);
          sctx.fillStyle = `rgba(255,255,255,${alpha})`;
          sctx.beginPath(); sctx.arc(s.x, s.y, rad, 0, Math.PI * 2); sctx.fill();
        }
        requestAnimationFrame(animateStarfield);
      }

      // --- Initialization ---
      function init() {
        // Event Listeners
        window.addEventListener('load', openIntro);
        window.addEventListener('resize', resizeStarfield);
        skipIntro.addEventListener('click', () => {
          barFill.style.width = '100%'; barPct.textContent = '100%'; closeIntro();
        });
        genBtn.addEventListener('click', handleGenerateClick);
        clearBtn.addEventListener('click', () => { history.length = 0; renderHistory(); });
        connectBtn.addEventListener('click', () => showScreen('connect'));
        feedbackBtn.addEventListener('click', () => showScreen('feedback'));
        backHome.addEventListener('click', () => showScreen('home'));
        backFromFeedback.addEventListener('click', () => showScreen('home'));
        sysConnect.addEventListener('click', handleSystemConnect);
        fbSendBtn.addEventListener('click', handleSendFeedback);
        document.querySelectorAll('.open-tg').forEach(a => a.addEventListener('click', handleSocialLink));
        
        // Initial Renders
        renderInitialFeeds();
        resizeStarfield();
        requestAnimationFrame(animateStarfield);
      }

      init();

    })();
  </script>

</body>
</html>
